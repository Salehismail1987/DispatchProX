<div
  class="modal fade come-from-modal right"
  id="myModalTicket"
  tabindex="-1"
  role="dialog"
  aria-labelledby="myModalLabel"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content modal-ticket">
      <div
        class="modal-body"
        *ngIf="ticketDetail?.tc_ticket && ticketDetail?.tc_ticket == 'YES'"
      >
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <div class="title-9 text-grey-shade2 mb-3px">Ticket IDs</div>
            <div class="dashboard-title">
              {{ this.ticketDetail?.ticket_no }}
            </div>
          </div>
          {{ setRounds() }}
          <div>
            <img
              (click)="showTicketImage()"
              *ngIf="this.ticketDetail?.required_paper_ticket_id == 'YES'"
              src="../assets/icons/driver-paperticket-icon.svg"
              height="20"
              class="mr-1 cursor-pointer"
            />
            <button [ngClass]="this.getStatusClass(this.ticketDetail?.status)">
              {{ this.ticketDetail?.status }}
            </button>
          </div>
        </div>
        <br />
        <nav class="d-flex justify-content-between">
          <div
            class="nav nav-pills nav-fill width-fit-content"
            id="nav-tab"
            role="tablist"
          >
            <a
              class="nav-item nav-link text-left active tabitem"
              id="nav-home-tab"
              data-toggle="tab"
              href="#ticket-detail"
              role="tab"
              aria-controls="nav-home"
              aria-selected="true"
              >Ticket details</a
            >
            <a
              class="nav-item nav-link text-left ml-15px tabitem"
              id="nav-profile-tab"
              data-toggle="tab"
              href="#round-detail"
              role="tab"
              aria-controls="nav-profile"
              aria-selected="false"
              >Job details</a
            >
          </div>
          <div class="" align="right">
            <div class="title-52 text-grey-shade2 text-right">Date</div>
            <div class="title-5-new">
              {{
                this.time_conversion(this.ticketDetail, 1).convertedDate
                  ? this.time_conversion(this.ticketDetail, 1).convertedDate
                  : this.ticketDetail?.ticket_date
              }}
            </div>
          </div>
        </nav>
        <div class="tab-content" id="nav-tabContent">
          <div
            class="tab-pane fade show active"
            id="ticket-detail"
            role="tabpanel"
            aria-labelledby="nav-home-tab"
          >
            <div class="ticket-detail-div bg-light-yellow2 no-border">
              <div class="p-10px">
                <div class="row">
                  <div class="col-6">
                    <div class="mb-8"></div>
                    <div class="title-10 text-black-shade2">
                      {{
                        this.ticketDetail?.customer
                          ? this.ticketDetail?.customer?.company_name
                          : this.ticketDetail?.tc_customer?.company_name
                      }}
                    </div>
                  </div>
                  <div class="col-6" align="right">
                    <div class="title-52 text-grey-shade2 text-right">
                      Project
                    </div>
                    <div class="title-5-new">
                      {{
                        this.ticketDetail?.project
                          ? this.ticketDetail?.project?.project_name
                          : this.ticketDetail?.tc_project?.project_name
                      }}
                    </div>
                  </div>
                </div>
              </div>

              <div class="myhr"></div>
              <div class="p-10px">
                <div class="row">
                  <div class="col-6">
                    <div class="title-52 text-grey-shade2">Job number</div>
                    <div class="title-5-new">
                      {{
                        this.ticketDetail?.project
                          ? this.ticketDetail?.project?.job_number
                          : this.ticketDetail?.tc_project?.job_number
                      }}
                    </div>
                  </div>
                  <div class="col-6" align="right">
                    <div class="title-5 text-grey-shade2 text-right">
                      Project address
                    </div>
                    <div class="title-5-new">
                      {{
                        this.ticketDetail?.project
                          ? this.ticketDetail?.project?.project_location
                          : this.ticketDetail?.tc_project?.project_location
                      }}
                    </div>
                  </div>
                </div>
              </div>
              <div class="myhr"></div>
              <div class="p-10px">
                <div class="row">
                  <div class="col-6">
                    <div class="title-52 text-grey-shade2">Job Approver</div>
                    <div class="title-5-new">
                      {{
                        this.ticketDetail?.approver &&
                        this.ticketDetail?.approver?.full_name
                          ? this.ticketDetail?.approver?.full_name
                          : this.ticketDetail?.tc_approver?.full_name
                      }}
                    </div>
                  </div>
                  <div class="col-6">
                    <div *ngIf="this.ticketDetail?.status == 'Accepted'"></div>
                    <div *ngIf="this.ticketDetail?.status == 'Approved'">
                      <div class="title-5 text-right">
                        Approved: Date / Time / Rate
                      </div>
                      <div class="title-5-new text-right">
                        {{
                          this.time_conversion(
                            this.ticketDetail?.driver_ticket?.approved_at,
                            3
                          ).convertedDate
                            ? this.time_conversion(
                                this.ticketDetail?.driver_ticket?.approved_at,
                                3
                              ).convertedDate
                            : (this.ticketDetail?.driver_ticket?.approved_at
                              | date : "shortDate")
                        }}
                        /
                        {{
                          this.time_conversion(
                            this.ticketDetail?.driver_ticket?.approved_at,
                            3
                          ).convertedTime
                            ? this.time_conversion(
                                this.ticketDetail?.driver_ticket?.approved_at,
                                3
                              ).convertedTime
                            : (this.ticketDetail?.driver_ticket?.approved_at
                              | date : "shortTime")
                        }}
                        /
                        {{
                          this.ticketDetail?.trucking_company_requests[0]
                            ?.rate_per_hour
                            ? "$" +
                              this.ticketDetail?.trucking_company_requests[0]
                                ?.rate_per_hour
                            : ""
                        }}
                      </div>
                    </div>
                    <div
                      *ngIf="
                        this.ticketDetail?.status != 'Approved' &&
                        this.ticketDetail?.dispatch_by?.account_type ==
                          'Customer' &&
                        this.ticketDetail?.dispatch_by?.id ==
                          this.ticketDetail?.user_id
                      "
                    >
                      <div class="title-5 text-right">Hour Rate</div>
                      <div class="title-5-new text-right">
                        {{
                          this.ticketDetail?.rate_per_hour
                            ? "$" + this.ticketDetail?.rate_per_hour
                            : ""
                        }}/hr
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div
                *ngIf="
                  this.ticketDetail?.dispatch_by?.account_type == 'Customer' &&
                  this.ticketDetail?.dispatch_by?.id ==
                    this.ticketDetail?.user_id
                "
              >
                <div class="myhr"></div>
                <div class="p-10px">
                  <div class="row">
                    <div class="col-6">
                      <div class="title-52 text-grey-shade2">Dispatcher</div>
                      <div class="title-5-new">
                        {{ this.ticketDetail?.dispatch_by?.full_name }}
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="title-52 text-grey-shade2 text-right">
                        Contact #
                      </div>
                      <div class="title-5-new text-right">
                        {{ this.ticketDetail?.dispatch_by?.contact_number }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="myhr"></div>
              <div class="p-10px">
                <div class="row">
                  <div class="col-12">
                    <div class="title-5">Description</div>
                    <div class="stats-status">
                      {{ this.ticketDetail?.description }}
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <ng-container
              *ngIf="
                this.ticketDetail?.trucking_company_requests &&
                this.ticketDetail?.trucking_company_requests.length > 0
              "
            >
              <ng-container
                *ngFor="
                  let reqDetail of this.ticketDetail?.trucking_company_requests
                "
              >
                <!--Customer-->

                <div
                  class="ticket-detail-div"
                  *ngIf="
                    reqDetail.dispatch_by?.id != this.user_id &&
                    reqDetail.dispatch_by !== null &&
                    reqDetail.dispatch_by?.account_type != 'Customer' &&
                    reqDetail.dispatch_to_id == this.user_id
                  "
                >
                  <div class="p-10px">
                    <div class="row">
                      <div class="col-6">
                        <div class="title-52 text-grey-shade2">Customer</div>
                        <div class="title-5-new">
                          {{ reqDetail?.dispatch_by?.company_name }}
                        </div>
                      </div>
                      <div class="col-6" align="right">
                        <div
                          class="title-52 text-grey-shade2 text-grey-shade2 text-right"
                        >
                          Hour rate
                        </div>
                        <div class="title-5-new text-right">
                          ${{ reqDetail?.rate_per_hour }}/hr
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="myhr"></div>
                  <div class="p-10px">
                    <div class="row">
                      <div class="col-6">
                        <div class="title-52 text-grey-shade2">Dispatcher</div>
                        <div class="title-5-new">
                          {{ reqDetail?.dispatch_by?.full_name }}
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="title-52 text-grey-shade2 text-right">
                          Contact #
                        </div>
                        <div class="title-5-new text-right">
                          {{ reqDetail?.dispatch_by?.contact_number }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- vendor -->
                <div
                  class="ticket-detail-div"
                  *ngIf="
                    reqDetail.id !== this.ticketDetail?.id &&
                    reqDetail.dispatch_to_id != this.user_id &&
                    reqDetail.dispatch_by_id == this.user_id
                  "
                >
                  <div class="p-10px">
                    <div class="row">
                      <div class="col-6">
                        <div class="title-52 text-grey-shade2">Vendor</div>
                        <div class="title-5-new">
                          {{ reqDetail?.dispatch_to?.company_name }}
                        </div>
                      </div>
                      <div class="col-6" align="right">
                        <div
                          class="title-52 text-grey-shade2 text-grey-shade2 text-right"
                        >
                          Hour rate
                        </div>
                        <div class="title-5-new text-right">
                          ${{ reqDetail?.rate_per_hour }}/hr
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="myhr"></div>
                  <div class="p-10px">
                    <div class="row">
                      <div class="col-6">
                        <div class="title-52 text-grey-shade2">
                          Accepted by:
                        </div>
                        <div class="title-5-new">
                          <ng-container *ngIf="reqDetail?.is_accepted == 1">
                            {{ reqDetail?.accepted_by?.full_name }}
                          </ng-container>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="title-52 text-grey-shade2 text-right">
                          Contact #
                        </div>
                        <div class="title-5-new text-right">
                          {{ reqDetail?.accepted_by?.contact_number }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </ng-container>
            </ng-container>

            <!-- driver/truck -->
            <div class="ticket-detail-div mybtn-back-pink no-border">
              <!-- For Pending Status-->
              <ng-container
                *ngIf="
                  this.ticketDetail?.status == 'Pending' &&
                  !this.ticketDetail?.driver_ticket
                "
              >
                <!-- truck detail -->
                <div class="p-10px">
                  <div class="row">
                    <div class="col-6">
                      <div class="title-52 text-grey-shade2">Truck type</div>
                      <div
                        class="title-5-new"
                        *ngIf="
                          this.ticketDetail?.is_tc_ticket &&
                          this.ticketDetail?.is_tc_ticket == 'YES'
                        "
                      >
                        {{ this.ticketDetail?.ticket_truck_type }}
                      </div>

                      <div
                        class="title-5-new"
                        *ngIf="
                          this.ticketDetail?.is_tc_ticket &&
                          !this.ticketDetail?.is_tc_ticket
                        "
                      >
                        {{
                          this.ticketDetail?.ticket_truck_type
                            ?.project_combination &&
                          this.ticketDetail?.ticket_truck_type
                            ?.project_combination?.truck
                            ? this.ticketDetail?.ticket_truck_type
                                ?.project_combination?.truck?.name
                            : this.ticketDetail?.ticket_truck_type
                                ?.project_truck
                            ? this.ticketDetail?.ticket_truck_type
                                ?.project_truck.name
                            : ""
                        }}
                      </div>
                    </div>

                    <div class="col-6" align="right">
                      <div class="title-52 text-grey-shade2 text-right">
                        Trailer type
                      </div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.ticket_truck_type?.project_trailer
                            ? this.ticketDetail?.ticket_truck_type
                                ?.project_trailer.name
                            : ""
                        }}
                      </div>
                    </div>
                  </div>
                </div>
                <div class="myhr myhr-white"></div>
                <div class="p-10px">
                  <div class="row">
                    <div class="col-6">
                      <div class="title-52 text-grey-shade2">Start time</div>
                      <div class="title-5-new">
                        <img
                          src="../../assets/icons/time-squar.svg"
                          width="11px"
                          class="mt-minus-3px"
                        />
                        {{
                          this.ticketDetail?.ticket_truck_type
                            ?.ticket_truck_type_rounds &&
                          this.ticketDetail?.ticket_truck_type
                            ?.ticket_truck_type_rounds[0]
                            ? this.ticketDetail?.ticket_truck_type
                                ?.ticket_truck_type_rounds[0]?.start_time
                            : ""
                        }}
                      </div>
                    </div>

                    <div class="col-6" align="right">
                      <div class="title-52 text-grey-shade2 text-right">
                        Truck interval
                      </div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.ticket_truck_type
                            ?.ticket_truck_type_rounds &&
                          this.ticketDetail?.ticket_truck_type
                            ?.ticket_truck_type_rounds[0]
                            ? this.ticketDetail?.ticket_truck_type
                                ?.ticket_truck_type_rounds[0]
                                ?.interval_between_truck
                            : ""
                        }}<img
                          src="../../assets/icons/time-squar.svg"
                          width="11px"
                          class="mt-minus-3px"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </ng-container>

              <!-- truck detail -->
              <ng-container
                *ngIf="
                  (this.ticketDetail?.status == 'Pending' &&
                    this.ticketDetail?.driver_ticket) ||
                  this.ticketDetail?.status == 'Accepted' ||
                  this.ticketDetail?.status == 'Driving'
                "
              >
                <div class="p-10px">
                  <div class="row">
                    <div class="col-4">
                      <div class="title-52 text-grey-shade2">Truck name</div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.driver_ticket?.truck
                            ?.truck_nickname
                        }}
                      </div>
                    </div>
                    <div class="col-4" align="center">
                      <div class="title-52 text-grey-shade2 text-center">
                        Truck type
                      </div>
                      <div class="title-5-new text-center">
                        {{
                          this.ticketDetail?.driver_ticket?.truck?.truck_type
                        }}
                      </div>
                    </div>
                    <div class="col-4" align="right">
                      <div class="title-52 text-grey-shade2 text-right">
                        License plate
                      </div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.driver_ticket?.truck
                            ?.truck_license_plate
                        }}
                      </div>
                    </div>
                  </div>
                </div>
                <ng-container
                  *ngIf="
                    this.ticketDetail?.driver_ticket?.trailer &&
                    this.ticketDetail?.driver_ticket?.trailer?.trailer_nickname
                  "
                >
                  <div class="myhr myhr-white"></div>
                  <div class="p-10px">
                    <div class="row">
                      <div class="col-4">
                        <div class="title-52 text-grey-shade2">
                          Trailer name
                        </div>
                        <div class="title-5-new">
                          {{
                            this.ticketDetail?.driver_ticket?.trailer
                              ?.trailer_nickname
                          }}
                        </div>
                      </div>
                      <div class="col-4" align="center">
                        <div class="title-52 text-grey-shade2 text-center">
                          Trailer type
                        </div>
                        <div class="title-5-new text-center">
                          {{
                            this.ticketDetail?.driver_ticket?.trailer
                              ?.trailer_type
                          }}
                        </div>
                      </div>
                      <div class="col-4" align="right">
                        <div class="title-52 text-grey-shade2 text-right">
                          License plate
                        </div>
                        <div class="title-5-new">
                          {{
                            this.ticketDetail?.driver_ticket?.trailer
                              ?.trailer_license_plate
                          }}
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-container>

                <!-- driver detail -->
                <div class="myhr myhr-white"></div>
                <div class="p-10px">
                  <div class="row">
                    <div class="col-4">
                      <div class="title-52 text-grey-shade2">Driver</div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.driver_ticket?.driver?.full_name
                        }}
                      </div>
                    </div>
                    <div class="col-4" align="center">
                      <div class="title-52 text-grey-shade2 text-center">
                        {{
                          this.ticketDetail?.status == "Driving"
                            ? "Job started"
                            : "Start time"
                        }}
                      </div>
                      <div
                        class="title-5-new text-center"
                        *ngIf="
                          this.ticketDetail?.status == 'Accepted' ||
                          (this.ticketDetail?.status == 'Pending' &&
                            this.ticketDetail?.driver_ticket)
                        "
                      >
                        <img
                          src="../../assets/icons/time-squar.svg"
                          width="11px"
                          class="mt-minus-3px"
                        />
                        {{ this.ticketDetail?.ticket_time }}
                      </div>
                      <div
                        class="title-5-new text-center"
                        *ngIf="this.ticketDetail?.status == 'Driving'"
                      >
                        <img
                          src="../../assets/icons/time-squar.svg"
                          width="11px"
                          class="mt-minus-3px"
                        />
                        {{
                          this.time_conversion(
                            this.ticketDetail?.driver_ticket?.started_at,
                            3
                          ).convertedTime
                            ? this.time_conversion(
                                this.ticketDetail?.driver_ticket?.started_at,
                                3
                              ).convertedTime
                            : (this.ticketDetail?.driver_ticket?.started_at
                              | date : "shortTime")
                        }}
                      </div>
                    </div>
                    <div class="col-4" align="right">
                      <div class="title-52 text-grey-shade2 text-right">
                        Rounds
                      </div>
                      <div class="title-5-new">
                        <img
                          src="../../assets/icons/restart.svg"
                          width="15px"
                          class="mt-minus-3px"
                        />
                        {{ this.total_rounds }}
                      </div>
                    </div>
                  </div>
                </div>
              </ng-container>
              <ng-container
                *ngIf="
                  this.ticketDetail?.status == 'Approved' ||
                  this.ticketDetail?.status == 'Completed'
                "
              >
                <div class="p-10px">
                  <div class="row">
                    <div class="col-6" align="left">
                      <div class="title-52 text-grey-shade2">Job started</div>
                      <div class="title-5-new">
                        {{
                          this.time_conversion(
                            this.ticketDetail?.driver_ticket?.started_at,
                            3
                          ).convertedTime
                            ? this.time_conversion(
                                this.ticketDetail?.driver_ticket?.started_at,
                                3
                              ).convertedTime
                            : (this.ticketDetail?.driver_ticket?.started_at
                              | date : "shortTime")
                        }}
                      </div>
                    </div>
                    <div class="col-6" align="right">
                      <div class="title-52 text-grey-shade2 text-right">
                        Job total
                      </div>
                      <div class="title-5-new">
                        {{
                          parseJobTotal(
                            this.ticketDetail?.driver_ticket?.total_time
                          )
                        }}
                      </div>
                    </div>
                  </div>
                </div>
                <div class="myhr myhr-white"></div>
                <div class="p-10px">
                  <div class="row">
                    <div class="col-6" align="left">
                      <div class="title-52 text-grey-shade2">Driver</div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.driver_ticket?.driver?.full_name
                        }}
                      </div>
                    </div>
                    <div class="col-6" align="right">
                      <div class="title-52 text-grey-shade2 text-right">
                        Driver total
                      </div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.rate_type == "round"
                            ? getSingleTicketRounds()
                            : parseDriverTime(
                                this.ticketDetail?.driver_ticket?.driver_hours,
                                this.ticketDetail?.driver_ticket?.driver_minutes
                              )
                        }}
                        {{
                          this.ticketDetail?.rate_type == "round"
                            ? "rounds"
                            : ""
                        }}
                      </div>
                    </div>
                  </div>
                </div>
              </ng-container>
            </div>

            <!-- <div class="ticket-detail-div">
                            <div class="p-10px">
                                <div class="row">
                                    <div class="col-4">
                                        <div class="title-5">Truck name</div>
                                        <div class="title-5-new">

                                            {{this.ticketDetail?.driver_ticket?.truck?.truck_nickname}}

                                        </div>
                                    </div>
                                    <div class="col-4" align="center">
                                        <div class="title-5 text-center">No. of rounds</div>
                                        <div class="title-5-new text-center">{{this.ticketDetail?.ticket_truck_type_rounds.length}}</div>
                                    </div>
                                    <div class="col-4" align="right">
                                        <div class="title-5 text-right">Truck type</div>
                                        <div class="title-5-new">    {{this.ticketDetail?.driver_ticket?.truck?.truck_type}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="myhr"></div>
                            <ng-container *ngIf="this.ticketDetail?.status == 'Accepted' || this.ticketDetail?.status == 'Driving' || this.ticketDetail?.status == 'Completed'">
                                <div class="p-10px">
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="title-5">Date</div>
                                            <div class="title-5-new">{{this.ticketDetail?.driver_ticket?.started_at | date:'shortDate'}}</div>
                                        </div>
                                        <div class="col-6" align="right">
                                            <div class="title-5 text-right">Time</div>
                                            <div class="title-5-new">{{this.ticketDetail?.driver_ticket?.started_at | date:'shortTime'}}</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="myhr"></div>
                                <div class="p-10px">
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="title-5">Driver</div>
                                            <div class="title-5-new">{{this.ticketDetail?.driver_ticket?.driver?.full_name}}</div>
                                        </div>
                                        <div class="col-6" align="right">
                                            <div class="title-5 text-right">Truck License </div>
                                            <div class="title-5-new">{{this.ticketDetail?.driver_ticket?.truck?.truck_license_plate}}</div>
                                        </div>
                                    </div>
                                </div>

                            </ng-container>

                        </div> -->
          </div>
          <div
            class="tab-pane fade"
            id="round-detail"
            role="tabpanel"
            aria-labelledby="nav-profile-tab"
          >
            <div class="title-summ mt-10px mb-10px">Job Summary</div>
            <div
              class="ticket-detail-div mb-20px"
              *ngIf="
                this.ticketDetail?.status == 'Approved' ||
                this.ticketDetail?.status == 'Completed'
              "
            >
              <div class="p-10px">
                <div class="row">
                  <div class="col-4">
                    <div class="title-52 text-grey-shade2">Truck name</div>
                    <div class="title-5-new">
                      {{
                        this.ticketDetail?.driver_ticket?.truck?.truck_nickname
                      }}
                    </div>
                  </div>
                  <div class="col-4" align="center">
                    <div class="title-52 text-grey-shade2 text-center">
                      Truck type
                    </div>
                    <div class="title-5-new text-center">
                      {{ this.ticketDetail?.driver_ticket?.truck?.truck_type }}
                    </div>
                  </div>
                  <div class="col-4" align="right">
                    <div class="title-52 text-grey-shade2 text-right">
                      License plate
                    </div>
                    <div class="title-5-new">
                      {{
                        this.ticketDetail?.driver_ticket?.truck
                          ?.truck_license_plate
                      }}
                    </div>
                  </div>
                </div>
              </div>
              <ng-container
                *ngIf="
                  this.ticketDetail?.driver_ticket?.trailer &&
                  this.ticketDetail?.driver_ticket?.trailer?.trailer_nickname
                "
              >
                <div class="myhr"></div>
                <div class="p-10px">
                  <div class="row">
                    <div class="col-4">
                      <div class="title-52 text-grey-shade2">Trailer name</div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.driver_ticket?.trailer
                            ?.trailer_nickname
                        }}
                      </div>
                    </div>
                    <div class="col-4" align="center">
                      <div class="title-52 text-grey-shade2 text-center">
                        Trailer type
                      </div>
                      <div class="title-5-new text-center">
                        {{
                          this.ticketDetail?.driver_ticket?.trailer
                            ?.trailer_type
                        }}
                      </div>
                    </div>
                    <div class="col-4" align="right">
                      <div class="title-52 text-grey-shade2 text-right">
                        License plate
                      </div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.driver_ticket?.trailer
                            ?.trailer_license_plate
                        }}
                      </div>
                    </div>
                  </div>
                </div>
              </ng-container>

              <div class="myhr"></div>

              <div class="p-10px">
                <div class="row">
                  <div class="col-4">
                    <div class="title-52 text-grey-shade2">Job started</div>
                    <div class="title-5-new">
                      {{
                        this.time_conversion(
                          this.ticketDetail?.driver_ticket?.started_at,
                          3
                        ).convertedTime
                          ? this.time_conversion(
                              this.ticketDetail?.driver_ticket?.started_at,
                              3
                            ).convertedTime
                          : (this.ticketDetail?.driver_ticket?.started_at
                            | date : "shortTime")
                      }}
                    </div>
                  </div>
                  <div class="col-4" align="center">
                    <div class="title-52 text-grey-shade2 text-center">
                      Rounds
                    </div>
                    <div class="title-5-new text-center">
                      <img
                        src="../../assets/icons/restart.svg"
                        width="15px"
                        class="mt-minus-3px"
                      />
                      {{ this.total_rounds }}
                    </div>
                  </div>
                  <div class="col-4" align="right">
                    <div class="title-52 text-grey-shade2 text-right">
                      Job total
                    </div>
                    <div class="title-5-new text-right">
                      {{
                        this.parseJobTotal2(
                          this.ticketDetail?.driver_ticket?.total_time
                        )
                      }}
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div
              class=""
              *ngIf="
                this.ticketDetail?.status == 'Approved' ||
                this.ticketDetail?.status == 'Completed'
              "
            >
              <div class="ticket-detail-div mb-20px">
                <div class="p-10px">
                  <div class="row">
                    <div class="col-4">
                      <div class="title-52 text-grey-shade2">Driver Total</div>
                      <div class="title-5-new">
                        <b>
                          {{
                            this.ticketDetail?.rate_type == "round"
                              ? getSingleTicketRounds()
                              : parseDriverTime(
                                  this.ticketDetail?.driver_ticket
                                    ?.driver_hours,
                                  this.ticketDetail?.driver_ticket
                                    ?.driver_minutes
                                )
                          }}
                          {{
                            this.ticketDetail?.rate_type == "round"
                              ? "rounds"
                              : ""
                          }}
                        </b>
                      </div>
                    </div>
                    <div class="col-8">
                      <div class="ticket-detail-div min-height-50 mt-0">
                        <div class="title-52 text-grey-shade2 pt-1">
                          Driver Notes:
                        </div>
                        <div class="title-5-new">
                          {{
                            this.ticketDetail?.driver_ticket?.notes_for_approver
                          }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="myhr"></div>
                <div class="p-10px">
                  <div class="row">
                    <div class="col-4">
                      <div class="title-52 text-grey-shade2">
                        Approved hours
                      </div>
                      <div class="title-5-new">
                        <b *ngIf="this.ticketDetail?.status == 'Completed'">
                          Waiting for
                          {{
                            this.ticketDetail?.approver
                              ? this.ticketDetail?.approver?.full_name
                              : this.ticketDetail?.tc_approver?.full_name
                          }}
                        </b>
                        <b *ngIf="this.ticketDetail?.status == 'Approved'">
                          <span
                            *ngIf="
                              this.ticketDetail?.status == 'Approved' &&
                              this.ticketDetail?.driver_ticket?.approver_time !=
                                ''
                            "
                          >
                            {{
                              this.ticketDetail?.driver_ticket?.approver_time
                                ? parseHour(
                                    this.ticketDetail?.driver_ticket
                                      ?.approver_time
                                  )
                                : ""
                            }}
                          </span>

                          <span
                            *ngIf="
                              this.ticketDetail?.status == 'Approved' &&
                              (this.ticketDetail?.driver_ticket
                                ?.approver_time == '' ||
                                this.ticketDetail?.driver_ticket
                                  ?.approver_time == 'null' ||
                                this.ticketDetail?.driver_ticket
                                  ?.approver_time == null)
                            "
                          >
                            {{
                              parseDriverTime(
                                this.ticketDetail?.driver_ticket?.driver_hours,
                                this.ticketDetail?.driver_ticket?.driver_minutes
                              )
                            }}
                          </span>
                        </b>
                      </div>
                    </div>
                    <div class="col-8">
                      <div class="ticket-detail-div min-height-50 mt-0">
                        <div class="title-52 text-grey-shade2 pt-1">
                          Notes From Approver:
                        </div>
                        <div class="title-5-new">
                          {{ this.ticketDetail?.driver_ticket?.approver_notes }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Approved , Download PDF-->
              <div
                class="p-10x mb-20px"
                *ngIf="this.ticketDetail?.status == 'Approved'"
              >
                <div class="row">
                  <div class="col-12 text-center" align="center">
                    <button
                      (click)="handlePDFDownload(this.ticketDetail)"
                      type="button"
                      class="mt-1 mybtn2 download-btn text-white"
                      *ngIf="!is_downloading"
                    >
                      Download PDF
                      <svg
                        width="24"
                        height="22"
                        viewBox="0 0 24 22"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M2 15.5557V18.0001C2 19.1047 2.89543 20.0001 4 20.0001H20C21.1046 20.0001 22 19.1047 22 18.0001V15.5557"
                          stroke="white"
                          stroke-width="2.5"
                        />
                        <path
                          d="M4.5 10.3701L11.8988 14.5238C12.218 14.703 12.6097 14.6935 12.9198 14.4989L19.5 10.3701"
                          stroke="white"
                          stroke-width="2.5"
                          stroke-linecap="round"
                        />
                        <line
                          x1="9.66675"
                          x2="9.66675"
                          y2="13.3333"
                          stroke="white"
                          stroke-width="2"
                        />
                        <line
                          x1="15.5"
                          x2="15.5"
                          y2="13.3333"
                          stroke="white"
                          stroke-width="2"
                        />
                      </svg>
                    </button>
                    <button
                      type="button"
                      class="mt-1 mybtn2 text-white download-btn"
                      *ngIf="is_downloading"
                      disbaled
                    >
                      Processing...
                    </button>
                  </div>
                </div>
              </div>

              <ng-container
                *ngFor="
                  let round of this.ticketDetail?.ticket_truck_type_rounds
                    .length > 0
                    ? this.ticketDetail?.ticket_truck_type_rounds
                    : this.ticketDetail?.ticket_truck_type
                        ?.ticket_truck_type_rounds
                    ? this.ticketDetail?.ticket_truck_type
                        ?.ticket_truck_type_rounds
                    : []
                "
              >
                <ng-container
                  *ngIf="
                    (this.ticketDetail?.status != 'Completed' &&
                      this.ticketDetail?.status != 'Approved') ||
                    ((this.ticketDetail?.status == 'Completed' ||
                      this.ticketDetail?.status == 'Approved') &&
                      round.driver_start_time &&
                      round.round_time)
                  "
                >
                  <div
                    [class]="
                      this.ticketDetail?.status == 'Driving' &&
                      round.driver_start_time != '' &&
                      round.driver_start_time &&
                      round.driver_start_time != null &&
                      (round.end_time == '' ||
                        !round.end_time ||
                        round.end_time == null)
                        ? 'title-5 mybtn bg-dark-yellow  width-fit-content btn-text-very-small2 text-white'
                        : 'title-5 done-round'
                    "
                  >
                    Round {{ round.round_no }}
                  </div>
                  <div class="ticket-detail-div mb-15px">
                    <div class="p-10px">
                      <div class="row">
                        <div class="col-md-6">
                          <div class="title-52 text-grey-shade2">
                            Material taken out
                          </div>
                          <div class="title-5-new">
                            {{ round.material_taken_out }}
                          </div>
                        </div>
                        <div class="col-md-6" align="right">
                          <div class="title-52 text-grey-shade2 text-right">
                            Dump site
                          </div>
                          <div class="title-5-new">{{ round.dump_site }}</div>
                        </div>
                      </div>
                    </div>
                    <div class="myhr"></div>
                    <div class="p-10px">
                      <div class="row">
                        <div class="col-6">
                          <div class="title-52 text-grey-shade2">
                            Round started
                          </div>
                          <div class="title-5-new">
                            {{
                              this.time_conversion(round.driver_start_time, 3)
                                .convertedTime
                                ? this.time_conversion(
                                    round.driver_start_time,
                                    3
                                  ).convertedTime
                                : (round.driver_start_time | date : "shortTime")
                            }}
                          </div>
                        </div>
                        <div class="col-6" align="right">
                          <div class="title-52 text-grey-shade2 text-right">
                            Round total
                          </div>
                          <div class="title-5-new text-right">
                            {{
                              round.round_time && round.round_time !== null
                                ? round.round_time + "m"
                                : ""
                            }}
                          </div>
                        </div>
                      </div>
                    </div>
                    <ng-container *ngIf="round?.haulback">
                      <div class="myhr"></div>
                      <div class="p-10px pt-1 grey-div">
                        <div class="row">
                          <div class="col-6">
                            <div class="title-52 text-grey-shade2 pb-1">
                              Haul back - pickup site
                            </div>
                            <div class="title-5-new">
                              {{
                                round?.haulback?.pickup_location_address
                                  ? round?.haulback?.pickup_location_address
                                  : round?.haulback?.pickup_location_name
                              }}
                            </div>
                          </div>
                          <div class="col-6" align="right">
                            <div
                              class="title-52 text-grey-shade2 text-right pb-1"
                            >
                              Material in
                            </div>
                            <div class="title-5-new text-right">
                              {{ round?.haulback?.material_in }}
                            </div>
                          </div>
                        </div>
                      </div>
                    </ng-container>
                    <div class="myhr"></div>
                    <div class="p-10px">
                      <div class="row">
                        <div class="col-md-12">
                          <ng-container *ngIf="round?.haulback">
                            <div class="title-52 text-black font-size-14 pb-1">
                              Haul back notes:
                              {{ round?.haulback?.haulback_notes }}
                            </div>
                          </ng-container>
                          <div class="title-52 text-black font-size-14 pb-1">
                            Driver: {{ round?.driver_notes }}
                          </div>
                          <div class="title-5-new"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <br />
                </ng-container>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-body" *ngIf="!ticketDetail?.tc_ticket">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <div class="title-9 text-grey-shade2 mb-3px">Ticket IDs</div>
            <div class="dashboard-title">
              {{ this.ticketDetail?.ticket_no }}
            </div>
          </div>
          <div>
            <img
              (click)="showTicketImage()"
              *ngIf="this.ticketDetail?.required_paper_ticket_id == 'YES'"
              src="../assets/icons/driver-paperticket-icon.svg"
              height="20"
              class="mr-1 cursor-pointer"
            />
            <button [ngClass]="this.getStatusClass(this.ticketDetail?.status)">
              {{ this.ticketDetail?.status }}
            </button>
          </div>
        </div>
        <br />
        <nav class="d-flex justify-content-between">
          <div
            class="nav nav-pills nav-fill width-fit-content"
            id="nav-tab"
            role="tablist"
          >
            <a
              class="nav-item nav-link text-left active tabitem"
              id="nav-home-tab"
              data-toggle="tab"
              href="#ticket-detail"
              role="tab"
              aria-controls="nav-home"
              aria-selected="true"
              >Ticket details</a
            >
            <a
              class="nav-item nav-link text-left ml-15px tabitem"
              id="nav-profile-tab"
              data-toggle="tab"
              href="#round-detail"
              role="tab"
              aria-controls="nav-profile"
              aria-selected="false"
              >Job details</a
            >
          </div>
          <div class="" align="right">
            <div class="title-52 text-grey-shade2 text-right">Date</div>
            <div class="title-5-new">
              {{
                this.time_conversion(this.ticketDetail, 1).convertedDate
                  ? this.time_conversion(this.ticketDetail, 1).convertedDate
                  : this.ticketDetail?.ticket_date
              }}
            </div>
          </div>
        </nav>
        <div class="tab-content" id="nav-tabContent">
          <div
            class="tab-pane fade show active"
            id="ticket-detail"
            role="tabpanel"
            aria-labelledby="nav-home-tab"
          >
            <div class="ticket-detail-div bg-light-yellow2 no-border">
              <div class="p-10px">
                <div class="row">
                  <div class="col-6">
                    <div class="mb-8"></div>
                    <div class="title-10 text-black-shade2">
                      {{ this.ticketDetail?.user?.company_name }}
                    </div>
                  </div>
                  <div class="col-6" align="right">
                    <div class="title-52 text-grey-shade2 text-right">
                      Project
                    </div>
                    <div class="title-5-new">
                      {{ this.ticketDetail?.project?.project_name }}
                    </div>
                  </div>
                </div>
              </div>

              <div class="myhr"></div>
              <div class="p-10px">
                <div class="row">
                  <div class="col-6">
                    <div class="title-52 text-grey-shade2">Job number</div>
                    <div class="title-5-new">
                      {{ this.ticketDetail?.project?.job_number }}
                    </div>
                  </div>
                  <div class="col-6" align="right">
                    <div class="title-5 text-grey-shade2 text-right">
                      Project address
                    </div>
                    <div class="title-5-new">
                      {{ this.ticketDetail?.project?.project_location }}
                    </div>
                  </div>
                </div>
              </div>
              <div class="myhr"></div>
              <div class="p-10px">
                <div class="row">
                  <div class="col-6">
                    <div class="title-52 text-grey-shade2">Job Approver</div>
                    <div class="title-5-new">
                      {{ this.ticketDetail?.approver?.full_name }}
                    </div>
                  </div>
                  <div class="col-6">
                    <div *ngIf="this.ticketDetail?.status == 'Accepted'"></div>
                    <div *ngIf="this.ticketDetail?.status == 'Approved'">
                      <div class="title-5 text-right">
                        Approved: Date / Time / Rate
                      </div>
                      <div class="title-5-new text-right">
                        {{
                          this.time_conversion(
                            this.ticketDetail?.driver_ticket?.approved_at,
                            3
                          ).convertedDate
                            ? this.time_conversion(
                                this.ticketDetail?.driver_ticket?.approved_at,
                                3
                              ).convertedDate
                            : (this.ticketDetail?.driver_ticket?.approved_at
                              | date : "shortDate")
                        }}
                        /
                        {{
                          this.time_conversion(
                            this.ticketDetail?.driver_ticket?.approved_at,
                            3
                          ).convertedTime
                            ? this.time_conversion(
                                this.ticketDetail?.driver_ticket?.approved_at,
                                3
                              ).convertedTime
                            : (this.ticketDetail?.driver_ticket?.approved_at
                              | date : "shortTime")
                        }}
                        /
                        {{
                          this.ticketDetail?.trucking_company_requests[0]
                            ?.rate_per_hour
                            ? "$" +
                              this.ticketDetail?.trucking_company_requests[0]
                                ?.rate_per_hour
                            : ""
                        }}
                      </div>
                    </div>
                    <div
                      *ngIf="
                        this.ticketDetail?.status != 'Approved' &&
                        this.ticketDetail?.dispatch_by?.account_type ==
                          'Customer' &&
                        this.ticketDetail?.dispatch_by?.id ==
                          this.ticketDetail?.user_id
                      "
                    >
                      <div class="title-5 text-right">Hour Rate</div>
                      <div class="title-5-new text-right">
                        {{
                          this.ticketDetail?.rate_per_hour
                            ? "$" + this.ticketDetail?.rate_per_hour
                            : ""
                        }}/{{
                          this.ticketDetail?.rate_type == "hour"
                            ? "hr"
                            : this.ticketDetail?.rate_type == "round"
                            ? "round"
                            : "hr"
                        }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div
                *ngIf="
                  this.ticketDetail?.dispatch_by?.account_type == 'Customer' &&
                  this.ticketDetail?.dispatch_by?.id ==
                    this.ticketDetail?.user_id
                "
              >
                <div class="myhr"></div>
                <div class="p-10px">
                  <div class="row">
                    <div class="col-6">
                      <div class="title-52 text-grey-shade2">Dispatcher</div>
                      <div class="title-5-new">
                        {{ this.ticketDetail?.dispatch_by?.full_name }}
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="title-52 text-grey-shade2 text-right">
                        Contact #
                      </div>
                      <div class="title-5-new text-right">
                        {{ this.ticketDetail?.dispatch_by?.contact_number }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="myhr"></div>
              <div class="p-10px">
                <div class="row">
                  <div class="col-12">
                    <div class="title-5">Description</div>
                    <div class="stats-status">
                      {{ this.ticketDetail?.description }}
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <ng-container
              *ngIf="
                this.ticketDetail?.trucking_company_requests &&
                this.ticketDetail?.trucking_company_requests.length > 0
              "
            >
              <ng-container
                *ngFor="
                  let reqDetail of this.ticketDetail?.trucking_company_requests
                "
              >
                <!--Customer-->

                <div
                  class="ticket-detail-div"
                  *ngIf="
                    reqDetail.dispatch_by !== null &&
                    reqDetail.dispatch_by?.account_type != 'Customer' &&
                    reqDetail.dispatch_to_id == this.user_id
                  "
                >
                  <div class="p-10px">
                    <div class="row">
                      <div class="col-6">
                        <div class="title-52 text-grey-shade2">Customer</div>
                        <div class="title-5-new">
                          {{ reqDetail?.dispatch_by?.full_name }}
                        </div>
                      </div>
                      <div class="col-6" align="right">
                        <div
                          class="title-52 text-grey-shade2 text-grey-shade2 text-right"
                        >
                          Hour rate
                        </div>
                        <div class="title-5-new text-right">
                          ${{ reqDetail?.rate_per_hour }}/{{
                            reqDetail?.rate_type == "hour"
                              ? "hr"
                              : reqDetail?.rate_type == "round"
                              ? "round"
                              : "hr"
                          }}
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="myhr"></div>
                  <div class="p-10px">
                    <div class="row">
                      <div class="col-6">
                        <div class="title-52 text-grey-shade2">Dispatcher</div>
                        <div class="title-5-new">
                          {{ reqDetail?.dispatch_by?.full_name }}
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="title-52 text-grey-shade2 text-right">
                          Contact #
                        </div>
                        <div class="title-5-new text-right">
                          {{ reqDetail?.dispatch_by?.contact_number }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- vendor -->
                <div
                  class="ticket-detail-div"
                  *ngIf="
                    reqDetail.id !== this.ticketDetail?.id &&
                    reqDetail.dispatch_by_id == this.user_id
                  "
                >
                  <div class="p-10px">
                    <div class="row">
                      <div class="col-6">
                        <div class="title-52 text-grey-shade2">Vendor</div>
                        <div class="title-5-new">
                          {{ reqDetail?.dispatch_to?.company_name }}
                        </div>
                      </div>
                      <div class="col-6" align="right">
                        <div
                          class="title-52 text-grey-shade2 text-grey-shade2 text-right"
                        >
                          Hour rate
                        </div>
                        <div class="title-5-new text-right">
                          ${{ reqDetail?.rate_per_hour }}/{{
                            reqDetail?.rate_type == "hour"
                              ? "hr"
                              : reqDetail?.rate_type == "round"
                              ? "round"
                              : "hr"
                          }}
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="myhr"></div>
                  <div class="p-10px">
                    <div class="row">
                      <div class="col-6">
                        <div class="title-52 text-grey-shade2">
                          Accepted by:
                        </div>
                        <div class="title-5-new">
                          <ng-container *ngIf="reqDetail?.is_accepted == 1">
                            {{ reqDetail?.accepted_by?.full_name }}
                          </ng-container>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="title-52 text-grey-shade2 text-right">
                          Contact #
                        </div>
                        <div class="title-5-new text-right">
                          {{ reqDetail?.accepted_by?.contact_number }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </ng-container>
            </ng-container>

            <!-- driver/truck -->
            <div class="ticket-detail-div mybtn-back-pink no-border">
              <!-- For Pending Status-->
              <ng-container
                *ngIf="
                  this.ticketDetail?.status == 'Pending' &&
                  !this.ticketDetail?.driver_ticket
                "
              >
                <!-- truck detail -->
                <div class="p-10px">
                  <div class="row">
                    <div class="col-6">
                      <div class="title-52 text-grey-shade2">Truck type</div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.ticket_truck_type
                            ?.project_combination &&
                          this.ticketDetail?.ticket_truck_type
                            ?.project_combination?.truck
                            ? this.ticketDetail?.ticket_truck_type
                                ?.project_combination?.truck?.name
                            : this.ticketDetail?.ticket_truck_type
                                ?.project_truck
                            ? this.ticketDetail?.ticket_truck_type
                                ?.project_truck.name
                            : ""
                        }}
                      </div>
                    </div>

                    <div class="col-6" align="right">
                      <div class="title-52 text-grey-shade2 text-right">
                        Trailer type
                      </div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.ticket_truck_type?.project_trailer
                            ? this.ticketDetail?.ticket_truck_type
                                ?.project_trailer.name
                            : ""
                        }}
                      </div>
                    </div>
                  </div>
                </div>
                <div class="myhr"></div>
                <div class="p-10px">
                  <div class="row">
                    <div class="col-6">
                      <div class="title-52 text-grey-shade2">Start time</div>
                      <div class="title-5-new">
                        <img
                          src="../../assets/icons/time-squar.svg"
                          width="11px"
                          class="mt-minus-3px"
                        />
                        {{
                          this.ticketDetail?.ticket_truck_type
                            ?.ticket_truck_type_rounds &&
                          this.ticketDetail?.ticket_truck_type
                            ?.ticket_truck_type_rounds[0]
                            ? this.ticketDetail?.ticket_truck_type
                                ?.ticket_truck_type_rounds[0]?.start_time
                            : ""
                        }}
                      </div>
                    </div>

                    <div class="col-6" align="right">
                      <div class="title-52 text-grey-shade2 text-right">
                        Truck interval
                      </div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.ticket_truck_type
                            ?.ticket_truck_type_rounds &&
                          this.ticketDetail?.ticket_truck_type
                            ?.ticket_truck_type_rounds[0]
                            ? this.ticketDetail?.ticket_truck_type
                                ?.ticket_truck_type_rounds[0]
                                ?.interval_between_truck
                            : ""
                        }}<img
                          src="../../assets/icons/time-squar.svg"
                          width="11px"
                          class="mt-minus-3px"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </ng-container>

              <!-- truck detail -->
              <ng-container
                *ngIf="
                  (this.ticketDetail?.status == 'Pending' &&
                    this.ticketDetail?.driver_ticket) ||
                  this.ticketDetail?.status == 'Accepted' ||
                  this.ticketDetail?.status == 'Driving'
                "
              >
                <div class="p-10px">
                  <div class="row">
                    <div class="col-4">
                      <div class="title-52 text-grey-shade2">Truck name</div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.driver_ticket?.truck
                            ?.truck_nickname
                        }}
                      </div>
                    </div>
                    <div class="col-4" align="center">
                      <div class="title-52 text-grey-shade2 text-center">
                        Truck type
                      </div>
                      <div class="title-5-new text-center">
                        {{
                          this.ticketDetail?.driver_ticket?.truck?.truck_type
                        }}
                      </div>
                    </div>
                    <div class="col-4" align="right">
                      <div class="title-52 text-grey-shade2 text-right">
                        License plate
                      </div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.driver_ticket?.truck
                            ?.truck_license_plate
                        }}
                      </div>
                    </div>
                  </div>
                </div>
                <ng-container
                  *ngIf="
                    this.ticketDetail?.driver_ticket?.trailer &&
                    this.ticketDetail?.driver_ticket?.trailer?.trailer_nickname
                  "
                >
                  <div class="myhr"></div>
                  <div class="p-10px">
                    <div class="row">
                      <div class="col-4">
                        <div class="title-52 text-grey-shade2">
                          Trailer name
                        </div>
                        <div class="title-5-new">
                          {{
                            this.ticketDetail?.driver_ticket?.trailer
                              ?.trailer_nickname
                          }}
                        </div>
                      </div>
                      <div class="col-4" align="center">
                        <div class="title-52 text-grey-shade2 text-center">
                          Trailer type
                        </div>
                        <div class="title-5-new text-center">
                          {{
                            this.ticketDetail?.driver_ticket?.trailer
                              ?.trailer_type
                          }}
                        </div>
                      </div>
                      <div class="col-4" align="right">
                        <div class="title-52 text-grey-shade2 text-right">
                          License plate
                        </div>
                        <div class="title-5-new">
                          {{
                            this.ticketDetail?.driver_ticket?.trailer
                              ?.trailer_license_plate
                          }}
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-container>

                <!-- driver detail -->
                <div class="myhr myhr-white"></div>
                <div class="p-10px">
                  <div class="row">
                    <div class="col-4">
                      <div class="title-52 text-grey-shade2">Driver</div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.driver_ticket?.driver?.full_name
                        }}
                      </div>
                    </div>
                    <div class="col-4" align="center">
                      <div class="title-52 text-grey-shade2 text-center">
                        {{
                          this.ticketDetail?.status == "Driving"
                            ? "Job started"
                            : "Start time"
                        }}
                      </div>
                      <div
                        class="title-5-new text-center"
                        *ngIf="
                          this.ticketDetail?.status == 'Accepted' ||
                          (this.ticketDetail?.status == 'Pending' &&
                            this.ticketDetail?.driver_ticket)
                        "
                      >
                        <img
                          src="../../assets/icons/time-squar.svg"
                          width="11px"
                          class="mt-minus-3px"
                        />
                        {{ this.ticketDetail?.ticket_time }}
                      </div>
                      <div
                        class="title-5-new text-center"
                        *ngIf="this.ticketDetail?.status == 'Driving'"
                      >
                        <img
                          src="../../assets/icons/time-squar.svg"
                          width="11px"
                          class="mt-minus-3px"
                        />
                        {{
                          this.time_conversion(
                            this.ticketDetail?.driver_ticket?.started_at,
                            3
                          ).convertedTime
                            ? this.time_conversion(
                                this.ticketDetail?.driver_ticket?.started_at,
                                3
                              ).convertedTime
                            : (this.ticketDetail?.driver_ticket?.started_at
                              | date : "shortTime")
                        }}
                      </div>
                    </div>
                    <div class="col-4" align="right">
                      <div class="title-52 text-grey-shade2 text-right">
                        Rounds
                      </div>
                      <div class="title-5-new">
                        <img
                          src="../../assets/icons/restart.svg"
                          width="15px"
                          class="mt-minus-3px"
                        />
                        {{ this.total_rounds }}
                      </div>
                    </div>
                  </div>
                </div>
              </ng-container>
              <ng-container
                *ngIf="
                  this.ticketDetail?.status == 'Approved' ||
                  this.ticketDetail?.status == 'Completed'
                "
              >
                <div class="p-10px">
                  <div class="row">
                    <div class="col-6" align="left">
                      <div class="title-52 text-grey-shade2">Job started</div>
                      <div class="title-5-new">
                        {{
                          this.time_conversion(
                            this.ticketDetail?.driver_ticket?.started_at,
                            3
                          ).convertedTime
                            ? this.time_conversion(
                                this.ticketDetail?.driver_ticket?.started_at,
                                3
                              ).convertedTime
                            : (this.ticketDetail?.driver_ticket?.started_at
                              | date : "shortTime")
                        }}
                      </div>
                    </div>
                    <div class="col-6" align="right">
                      <div class="title-52 text-grey-shade2 text-right">
                        Job total
                      </div>
                      <div class="title-5-new">
                        {{
                          parseJobTotal(
                            this.ticketDetail?.driver_ticket?.total_time
                          )
                        }}
                      </div>
                    </div>
                  </div>
                </div>
                <div class="myhr myhr-white"></div>
                <div class="p-10px">
                  <div class="row">
                    <div class="col-6" align="left">
                      <div class="title-52 text-grey-shade2">Driver</div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.driver_ticket?.driver?.full_name
                        }}
                      </div>
                    </div>
                    <div class="col-6" align="right">
                      <div class="title-52 text-grey-shade2 text-right">
                        Driver total
                      </div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.rate_type == "round"
                            ? getSingleTicketRounds()
                            : parseDriverTime(
                                this.ticketDetail?.driver_ticket?.driver_hours,
                                this.ticketDetail?.driver_ticket?.driver_minutes
                              )
                        }}
                        {{
                          this.ticketDetail?.rate_type == "round"
                            ? "rounds"
                            : ""
                        }}
                      </div>
                    </div>
                  </div>
                </div>
              </ng-container>
            </div>

            <!-- <div class="ticket-detail-div">
                            <div class="p-10px">
                                <div class="row">
                                    <div class="col-4">
                                        <div class="title-5">Truck name</div>
                                        <div class="title-5-new">

                                            {{this.ticketDetail?.driver_ticket?.truck?.truck_nickname}}

                                        </div>
                                    </div>
                                    <div class="col-4" align="center">
                                        <div class="title-5 text-center">No. of rounds</div>
                                        <div class="title-5-new text-center">{{this.ticketDetail?.ticket_truck_type_rounds.length}}</div>
                                    </div>
                                    <div class="col-4" align="right">
                                        <div class="title-5 text-right">Truck type</div>
                                        <div class="title-5-new">    {{this.ticketDetail?.driver_ticket?.truck?.truck_type}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="myhr"></div>
                            <ng-container *ngIf="this.ticketDetail?.status == 'Accepted' || this.ticketDetail?.status == 'Driving' || this.ticketDetail?.status == 'Completed'">
                                <div class="p-10px">
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="title-5">Date</div>
                                            <div class="title-5-new">{{this.ticketDetail?.driver_ticket?.started_at | date:'shortDate'}}</div>
                                        </div>
                                        <div class="col-6" align="right">
                                            <div class="title-5 text-right">Time</div>
                                            <div class="title-5-new">{{this.ticketDetail?.driver_ticket?.started_at | date:'shortTime'}}</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="myhr"></div>
                                <div class="p-10px">
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="title-5">Driver</div>
                                            <div class="title-5-new">{{this.ticketDetail?.driver_ticket?.driver?.full_name}}</div>
                                        </div>
                                        <div class="col-6" align="right">
                                            <div class="title-5 text-right">Truck License </div>
                                            <div class="title-5-new">{{this.ticketDetail?.driver_ticket?.truck?.truck_license_plate}}</div>
                                        </div>
                                    </div>
                                </div>

                            </ng-container>

                        </div> -->
          </div>
          <div
            class="tab-pane fade"
            id="round-detail"
            role="tabpanel"
            aria-labelledby="nav-profile-tab"
          >
            <div class="title-summ mt-10px mb-10px">Job Summary</div>
            <div
              class="ticket-detail-div mb-20px"
              *ngIf="
                this.ticketDetail?.status == 'Approved' ||
                this.ticketDetail?.status == 'Completed'
              "
            >
              <div class="p-10px">
                <div class="row">
                  <div class="col-4">
                    <div class="title-52 text-grey-shade2">Truck name</div>
                    <div class="title-5-new">
                      {{
                        this.ticketDetail?.driver_ticket?.truck?.truck_nickname
                      }}
                    </div>
                  </div>
                  <div class="col-4" align="center">
                    <div class="title-52 text-grey-shade2 text-center">
                      Truck type
                    </div>
                    <div class="title-5-new text-center">
                      {{ this.ticketDetail?.driver_ticket?.truck?.truck_type }}
                    </div>
                  </div>
                  <div class="col-4" align="right">
                    <div class="title-52 text-grey-shade2 text-right">
                      License plate
                    </div>
                    <div class="title-5-new">
                      {{
                        this.ticketDetail?.driver_ticket?.truck
                          ?.truck_license_plate
                      }}
                    </div>
                  </div>
                </div>
              </div>
              <ng-container
                *ngIf="
                  this.ticketDetail?.driver_ticket?.trailer &&
                  this.ticketDetail?.driver_ticket?.trailer?.trailer_nickname
                "
              >
                <div class="myhr"></div>
                <div class="p-10px">
                  <div class="row">
                    <div class="col-4">
                      <div class="title-52 text-grey-shade2">Trailer name</div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.driver_ticket?.trailer
                            ?.trailer_nickname
                        }}
                      </div>
                    </div>
                    <div class="col-4" align="center">
                      <div class="title-52 text-grey-shade2 text-center">
                        Trailer type
                      </div>
                      <div class="title-5-new text-center">
                        {{
                          this.ticketDetail?.driver_ticket?.trailer
                            ?.trailer_type
                        }}
                      </div>
                    </div>
                    <div class="col-4" align="right">
                      <div class="title-52 text-grey-shade2 text-right">
                        License plate
                      </div>
                      <div class="title-5-new">
                        {{
                          this.ticketDetail?.driver_ticket?.trailer
                            ?.trailer_license_plate
                        }}
                      </div>
                    </div>
                  </div>
                </div>
              </ng-container>

              <div class="myhr"></div>

              <div class="p-10px">
                <div class="row">
                  <div class="col-4">
                    <div class="title-52 text-grey-shade2">Job started</div>
                    <div class="title-5-new">
                      {{
                        this.time_conversion(
                          this.ticketDetail?.driver_ticket?.started_at,
                          3
                        ).convertedTime
                          ? this.time_conversion(
                              this.ticketDetail?.driver_ticket?.started_at,
                              3
                            ).convertedTime
                          : (this.ticketDetail?.driver_ticket?.started_at
                            | date : "shortTime")
                      }}
                    </div>
                  </div>
                  <div class="col-4" align="center">
                    <div class="title-52 text-grey-shade2 text-center">
                      Rounds
                    </div>
                    <div class="title-5-new text-center">
                      <img
                        src="../../assets/icons/restart.svg"
                        width="15px"
                        class="mt-minus-3px"
                      />
                      {{ this.getSingleTicketRounds() }}
                    </div>
                  </div>
                  <div class="col-4" align="right">
                    <div class="title-52 text-grey-shade2 text-right">
                      Job total
                    </div>
                    <div class="title-5-new text-right">
                      {{
                        this.parseJobTotal2(
                          this.ticketDetail?.driver_ticket?.total_time
                        )
                      }}
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div
              class=""
              *ngIf="
                this.ticketDetail?.status == 'Approved' ||
                this.ticketDetail?.status == 'Completed'
              "
            >
              <div class="ticket-detail-div mb-20px">
                <div class="p-10px">
                  <div class="row">
                    <div class="col-4">
                      <div class="title-52 text-grey-shade2">Driver Total</div>
                      <div class="title-5-new">
                        <b>
                          {{
                            this.ticketDetail?.rate_type == "hour"
                              ? parseDriverTime(
                                  this.ticketDetail?.driver_ticket
                                    ?.driver_hours,
                                  this.ticketDetail?.driver_ticket
                                    ?.driver_minutes
                                )
                              : this.getSingleTicketRounds() + " rounds"
                          }}
                        </b>
                      </div>
                    </div>
                    <div class="col-8">
                      <div class="ticket-detail-div min-height-50 mt-0">
                        <div class="title-52 text-grey-shade2 pt-1">
                          Driver Notes:
                        </div>
                        <div class="title-5-new">
                          {{
                            this.ticketDetail?.driver_ticket?.notes_for_approver
                          }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="myhr"></div>
                <div class="p-10px">
                  <div class="row">
                    <div class="col-4">
                      <div class="title-52 text-grey-shade2">
                        Approved
                        {{
                          this.ticketDetail?.rate_type == "hour"
                            ? "hours"
                            : "rounds"
                        }}
                      </div>
                      <div class="title-5-new">
                        <b *ngIf="this.ticketDetail?.status == 'Completed'">
                          Waiting for
                          {{ this.ticketDetail?.approver?.full_name }}
                        </b>
                        <b *ngIf="this.ticketDetail?.status == 'Approved'">
                          <span
                            *ngIf="
                              this.ticketDetail?.status == 'Approved' &&
                              this.ticketDetail?.rate_type == 'hour' &&
                              this.ticketDetail?.driver_ticket?.approver_time !=
                                ''
                            "
                          >
                            {{
                              this.ticketDetail?.driver_ticket?.approver_time
                                ? parseHour(
                                    this.ticketDetail?.driver_ticket
                                      ?.approver_time
                                  )
                                : ""
                            }}
                          </span>

                          <span
                            *ngIf="
                              this.ticketDetail?.status == 'Approved' &&
                              this.ticketDetail?.rate_type == 'hour' &&
                              (this.ticketDetail?.driver_ticket
                                ?.approver_time == '' ||
                                this.ticketDetail?.driver_ticket
                                  ?.approver_time == 'null' ||
                                this.ticketDetail?.driver_ticket
                                  ?.approver_time == null)
                            "
                          >
                            {{
                              parseDriverTime(
                                this.ticketDetail?.driver_ticket?.driver_hours,
                                this.ticketDetail?.driver_ticket?.driver_minutes
                              )
                            }}
                          </span>

                          <span
                            *ngIf="
                              this.ticketDetail?.status == 'Approved' &&
                              this.ticketDetail?.rate_type == 'round' &&
                              this.ticketDetail?.driver_ticket
                                ?.approver_rounds != '' &&
                              this.ticketDetail?.driver_ticket
                                ?.approver_rounds != null
                            "
                          >
                            {{
                              this.ticketDetail?.driver_ticket?.approver_rounds
                                ? this.ticketDetail?.driver_ticket
                                    ?.approver_rounds + " rounds"
                                : ""
                            }}
                          </span>

                          <span
                            *ngIf="
                              this.ticketDetail?.status == 'Approved' &&
                              this.ticketDetail?.rate_type == 'round' &&
                              (this.ticketDetail?.driver_ticket
                                ?.approver_rounds == '' ||
                                this.ticketDetail?.driver_ticket
                                  ?.approver_rounds == null)
                            "
                          >
                            {{ this.getSingleTicketRounds() + " rounds" }}
                          </span>
                        </b>
                      </div>
                    </div>
                    <div class="col-8">
                      <div class="ticket-detail-div min-height-50 mt-0">
                        <div class="title-52 text-grey-shade2 pt-1">
                          Notes From Approver:
                        </div>
                        <div class="title-5-new">
                          {{ this.ticketDetail?.driver_ticket?.approver_notes }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Approved , Download PDF-->
              <div
                class="p-10x mb-20px"
                *ngIf="this.ticketDetail?.status == 'Approved'"
              >
                <div class="row">
                  <div class="col-12 text-center" align="center">
                    <button
                      (click)="handlePDFDownload(this.ticketDetail)"
                      type="button"
                      class="mt-1 mybtn2 download-btn text-white"
                      *ngIf="!is_downloading"
                    >
                      Download PDF
                      <svg
                        width="24"
                        height="22"
                        viewBox="0 0 24 22"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M2 15.5557V18.0001C2 19.1047 2.89543 20.0001 4 20.0001H20C21.1046 20.0001 22 19.1047 22 18.0001V15.5557"
                          stroke="white"
                          stroke-width="2.5"
                        />
                        <path
                          d="M4.5 10.3701L11.8988 14.5238C12.218 14.703 12.6097 14.6935 12.9198 14.4989L19.5 10.3701"
                          stroke="white"
                          stroke-width="2.5"
                          stroke-linecap="round"
                        />
                        <line
                          x1="9.66675"
                          x2="9.66675"
                          y2="13.3333"
                          stroke="white"
                          stroke-width="2"
                        />
                        <line
                          x1="15.5"
                          x2="15.5"
                          y2="13.3333"
                          stroke="white"
                          stroke-width="2"
                        />
                      </svg>
                    </button>
                    <button
                      type="button"
                      class="mt-1 mybtn2 text-white download-btn"
                      *ngIf="is_downloading"
                      disbaled
                    >
                      Processing...
                    </button>
                  </div>
                </div>
              </div>
              <ng-container
                *ngFor="
                  let round of this.ticketDetail?.ticket_truck_type_rounds
                    .length > 0
                    ? this.ticketDetail?.ticket_truck_type_rounds
                    : this.ticketDetail?.ticket_truck_type
                        ?.ticket_truck_type_rounds
                    ? this.ticketDetail?.ticket_truck_type
                        ?.ticket_truck_type_rounds
                    : []
                "
              >
                <ng-container
                  *ngIf="
                    (this.ticketDetail?.status != 'Completed' &&
                      this.ticketDetail?.status != 'Approved') ||
                    ((this.ticketDetail?.status == 'Completed' ||
                      this.ticketDetail?.status == 'Approved') &&
                      round.driver_start_time &&
                      round.round_time)
                  "
                >
                  <div
                    [class]="
                      this.ticketDetail?.status == 'Driving' &&
                      round.driver_start_time != '' &&
                      round.driver_start_time &&
                      round.driver_start_time != null &&
                      (round.end_time == '' ||
                        !round.end_time ||
                        round.end_time == null)
                        ? 'title-5 mybtn bg-dark-yellow  width-fit-content btn-text-very-small2 text-white'
                        : 'title-5 done-round'
                    "
                  >
                    Round {{ round.round_no }}
                  </div>
                  <div class="ticket-detail-div mb-15px">
                    <div class="p-10px">
                      <div class="row">
                        <div class="col-md-6">
                          <div class="title-52 text-grey-shade2">
                            Material taken out
                          </div>
                          <div class="title-5-new">
                            {{ round.material_taken_out }}
                          </div>
                        </div>
                        <div class="col-md-6" align="right">
                          <div class="title-52 text-grey-shade2 text-right">
                            Dump site
                          </div>
                          <div class="title-5-new">{{ round.dump_site }}</div>
                        </div>
                      </div>
                    </div>
                    <div class="myhr"></div>
                    <div class="p-10px">
                      <div class="row">
                        <div class="col-6">
                          <div class="title-52 text-grey-shade2">
                            Round started
                          </div>
                          <div class="title-5-new">
                            {{
                              this.time_conversion(round.driver_start_time, 3)
                                .convertedTime
                                ? this.time_conversion(
                                    round.driver_start_time,
                                    3
                                  ).convertedTime
                                : (round.driver_start_time | date : "shortTime")
                            }}
                          </div>
                        </div>
                        <div class="col-6" align="right">
                          <div class="title-52 text-grey-shade2 text-right">
                            Round total
                          </div>
                          <div class="title-5-new text-right">
                            {{
                              round.round_time && round.round_time !== null
                                ? round.round_time + "m"
                                : ""
                            }}
                          </div>
                        </div>
                      </div>
                    </div>
                    <ng-container *ngIf="round?.haulback">
                      <div class="myhr"></div>
                      <div class="p-10px pt-1 grey-div">
                        <div class="row">
                          <div class="col-6">
                            <div class="title-52 text-grey-shade2 pb-1">
                              Haul back - pickup site
                            </div>
                            <div class="title-5-new">
                              {{
                                round?.haulback?.pickup_location_address
                                  ? round?.haulback?.pickup_location_address
                                  : round?.haulback?.pickup_location_name
                              }}
                            </div>
                          </div>
                          <div class="col-6" align="right">
                            <div
                              class="title-52 text-grey-shade2 text-right pb-1"
                            >
                              Material in
                            </div>
                            <div class="title-5-new text-right">
                              {{ round?.haulback?.material_in }}
                            </div>
                          </div>
                        </div>
                      </div>
                    </ng-container>
                    <div class="myhr"></div>
                    <div class="p-10px">
                      <div class="row">
                        <div class="col-md-12">
                          <ng-container *ngIf="round?.haulback">
                            <div class="title-52 text-black font-size-14 pb-1">
                              Haul back notes:
                              {{ round?.haulback?.haulback_notes }}
                            </div>
                          </ng-container>
                          <div class="title-52 text-black font-size-14 pb-1">
                            Driver: {{ round?.driver_notes }}
                          </div>
                          <div class="title-5-new"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <br />
                </ng-container>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div
  class="modal fade come-from-modal right"
  id="myModalGetCamera"
  tabindex="-1"
  role="dialog"
  aria-labelledby="myModalLabel"
>
  <div class="modal-dialog" role="document">
    <div class="modal-content modal-image">
      <div class="modal-body">
        <div class="d-flex justify-content-between align-items-center mb-17">
          <div class="d-flex align-items-center">
            <input
              type="checkbox"
              name=""
              [checked]="
                this.loggedinUser?.open_paper_ticket_photo == 'YES'
                  ? true
                  : false
              "
              id=""
              value="1"
              (change)="checkOpenTicketPhoto($event)"
            />
            <div class="text-13px-semibold2 ml-15">Open as defaut option</div>
          </div>

          <div class="d-flex align-items-center">
            <div>
              <img src="../../assets/icons/camera-grey.png" alt="" />
            </div>
            <div class="div-4 ml-15 cursor-pointer">
              <img
                src="../../assets/icons/arrow-right-blue.png"
                alt=""
                (click)="closeModal2()"
                data-dismiss="modal"
                data-db-dismiss="modal"
              />
            </div>
          </div>
        </div>
        <ng-container
          *ngIf="this.ticketDetail?.paper_ticket_photo; else elseBlockPhoto"
        >
          <img
            [src]="this.paperImageURL + this.ticketDetail?.paper_ticket_photo"
            alt=""
            width="100%"
          />
        </ng-container>
        <ng-template #elseBlockPhoto>
          <div class="div-grey-bg">
            <div class="border-div">
              <div class="sub-div">
                <div class="text-13px-semibold text-grey mb-4">
                  No picture available
                </div>
              </div>
              <div class="myhr-1px"></div>
              <div class="sub-div">
                <div
                  class="row d-flex align-items-center justify-content-between"
                >
                  <div class="col-6 pr-2">
                    <div class="text-13px-semibold2 text-grey">
                      Ticket completed by
                    </div>
                    <div class="title-5 text-bold text-dark">
                      {{ this.ticketDetail?.approver?.full_name }} /
                      {{ this.ticketDetail?.user?.full_name }}
                    </div>
                  </div>

                  <div class="col-6 text-right pl-2">
                    <div class="text-13px-semibold2 text-grey">Date / Time</div>
                    <div class="title-5 text-bold text-dark text-right">
                      {{ this.ticketDetail?.ticket_date }} /
                      {{ this.ticketDetail?.ticket_time }}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
      </div>
    </div>
  </div>
</div>
